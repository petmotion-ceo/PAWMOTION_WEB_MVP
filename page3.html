function saveAsImage() {
  const frameWrapper = document.querySelector('.frame-wrapper');
  const ticketTitle = document.querySelector('.ticket-title');
  const saveBtn = document.querySelector('.save-btn');
  const analyzeBtn = document.querySelector('.analyze-btn');
  const topBar = document.querySelector('.top-bar');
  const addImageBtn = document.querySelector('.add-image-btn');

  // 현재 스타일 저장
  const originalStyles = {
    ticketTitle: ticketTitle.style.display,
    saveBtn: saveBtn.style.display,
    analyzeBtn: analyzeBtn.style.display,
    topBar: topBar.style.display,
    addImageBtn: addImageBtn.style.display
  };

  // 불필요한 요소 숨기기
  ticketTitle.style.display = 'none';
  saveBtn.style.display = 'none';
  analyzeBtn.style.display = 'none';
  topBar.style.display = 'none';
  addImageBtn.style.display = 'none';

  // 화면에 보이는 크기 가져오기
  const rect = frameWrapper.getBoundingClientRect();
  const scaleFactor = window.devicePixelRatio; // 디바이스 해상도에 맞춘 스케일

  html2canvas(frameWrapper, {
    x: rect.left,           // 캡처 시작 위치 (화면 기준)
    y: rect.top,            // 캡처 시작 위치 (화면 기준)
    width: rect.width,      // 화면에 보이는 너비
    height: rect.height,    // 화면에 보이는 높이
    scale: scaleFactor,     // 고해상도 및 비율 유지
    useCORS: true,          // 외부 이미지 포함 시 필요
    logging: true           // 디버깅용 로그 활성화
  }).then(canvas => {
    // 원래 스타일 복구
    ticketTitle.style.display = originalStyles.ticketTitle;
    saveBtn.style.display = originalStyles.saveBtn;
    analyzeBtn.style.display = originalStyles.analyzeBtn;
    topBar.style.display = originalStyles.topBar;
    addImageBtn.style.display = originalStyles.addImageBtn;

    // 이미지 다운로드
    const link = document.createElement('a');
    link.download = 'ticket.png';
    link.href = canvas.toDataURL('image/png');
    link.click();
    console.log("이미지 저장 완료");
  }).catch(err => {
    // 오류 처리
    console.error("html2canvas 오류:", err);
    ticketTitle.style.display = originalStyles.ticketTitle;
    saveBtn.style.display = originalStyles.saveBtn;
    analyzeBtn.style.display = originalStyles.analyzeBtn;
    topBar.style.display = originalStyles.topBar;
    addImageBtn.style.display = originalStyles.addImageBtn;
    alert("이미지 저장 중 오류가 발생했습니다.");
  });
}
